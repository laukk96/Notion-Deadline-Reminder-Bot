// require external
var crypto = require('crypto');

function createPassword (pepper, password) {
	var salt = crypto.randomBytes(64).toString('hex');
	var hashed = crypto.createHash('sha512').update(password + salt + pepper).digest('base64');
	return {
		password: hashed,
		salt: salt
	};
}

function checkPassword (pepper, password, hashedPassword, salt) {
	return crypto.createHash('sha512').update(password + salt + pepper).digest('base64') === hashedPassword;
}

function createToken () {
	return crypto.randomBytes(64).toString('hex');
}

module.exports = {
	createPassword: createPassword,
	checkPassword: checkPassword,
	createToken: createToken
};
